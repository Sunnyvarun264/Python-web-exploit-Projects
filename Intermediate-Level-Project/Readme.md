
# Packet sniffer

## Overview

Packet sniffer is a powerful tool designed to capture and analyze network packets on a specified interface. It provides detailed information about the captured packets and allows for saving and reviewing logs, making it a valuable tool for network administrators and security professionals.

## Features

- Capture packets on a specified network interface.
- Apply BPF filters to capture specific types of packets (e.g., TCP, UDP, ICMP).
- Save captured packets to a log file for later analysis.
- Display the contents of a saved log file.
- List available network interfaces.
- Use colored output for better readability.
- Cross-platform compatibility.

## Prerequisites

- Python 3.x
- `scapy` library
- `colorama` library
- Root/Administrator privileges

## Installation

1. **Install Scapy and Colorama**:
    ```sh
    pip install scapy colorama
    ```

2. **Download manuf.txt**:
    Download `manuf.txt` from the [Wireshark repository](https://raw.githubusercontent.com/wireshark/manuf/master/manuf) and place it in the specified directory (`/home/kali/Documents/Albus_Exploit_Project` by default).

3. **Ensure Root Privileges**:
    The script must be run with root/administrator privileges to capture packets.

## Usage

```sh
python packet_interceptor.py [-i INTERFACE] [-f FILTER] [-l] [-s [LOG_FILE]] [--logfile LOG_FILE]
```

### Options

- `-i, --iface`: Network interface to use for capturing packets (e.g., `eth0`).
- `-f, --filter`: BPF filter rule to apply for packet capture (e.g., `tcp`). Default is an empty string.
- `-l, --list`: List available network interfaces and exit.
- `-s, --savelog`: Path to a log file to save captured network traffic (default is `logfile.log`).
- `--logfile`: Path to a log file to display its contents.

### Examples

1. **Capture packets on a specific interface**:
    ```sh
    sudo python packet_interceptor.py -i eth0
    ```

2. **Capture only TCP packets**:
    ```sh
    sudo python packet_interceptor.py -i eth0 -f tcp
    ```

3. **Save captured packets to a log file**:
    ```sh
    sudo python packet_interceptor.py -i eth0 -s /path/to/logfile.log
    ```

4. **List available network interfaces**:
    ```sh
    python packet_interceptor.py -l
    ```

5. **Display contents of a log file**:
    ```sh
    python packet_interceptor.py --logfile /path/to/logfile.log
    ```

## Script Description

### Initialization and Setup

- The script starts by importing necessary modules and setting up `colorama` for colored console output.
- It checks for the existence of the `manuf.txt` file and sets the `SCAPY_MANUF_PATH` environment variable.

### PacketInterceptor Class

- **Initialization**: Sets up the network interface, filter rule, and log file.
- **_process_packet**: Processes each captured packet, extracting source and destination IP addresses, and other relevant details. Logs the information to the console and optionally to a file.
- **_start_sniffing**: Starts packet sniffing on the specified interface using Scapy.
- **start**: Starts the packet capture in a separate thread.
- **stop**: Stops the packet capture.
- **display_log**: Displays the contents of the log file.

### Utility Functions

- **is_admin**: Checks if the script is running with administrative privileges.
- **list_interfaces**: Lists available network interfaces.

### Main Function

- Parses command-line arguments and handles user inputs.
- Ensures the script is run with root privileges.
- Initializes and starts the packet interceptor.
- Provides an interactive prompt for stopping the packet capture.

## Notes

- The script must be run with root privileges to capture packets.
- Ensure the `manuf.txt` file is downloaded and placed in the specified directory.
- Use appropriate filters to capture only the required packets, reducing the load on the system.

## License

This project is licensed under the MIT License.  