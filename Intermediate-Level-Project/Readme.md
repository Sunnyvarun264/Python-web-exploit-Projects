
# Packet sniffer

## Overview

The packet sniffer and  Analyzer is a Python script that captures and analyzes network packets on a specified interface. It provides detailed statistics on various protocols and prints packet details to the console.

## Features

- Capture packets on a specified network interface.
- Identify and classify protocols based on port numbers and IP protocol fields.
- Print packet details including protocol, source IP, destination IP, source port, and destination port.
- Maintain and print packet statistics for each protocol.

## Prerequisites

- Python 3.x
- `scapy` library

## Installation

1. **Install Scapy**:
    ```sh
    pip install scapy
    ```

2. **Ensure Root Privileges**:
    The script must be run with root/administrator privileges to capture packets.

## Usage

```sh
sudo python network_packet_analyzer.py -i INTERFACE
```

### Options

- `-i, --interface`: Network interface to use for capturing packets (e.g., `eth0`, `wlan0`).

### Example

1. **Capture packets on a specific interface**:
    ```sh
    sudo python network_packet_analyzer.py -i eth0
    ```

## Script Description

### Initialization and Setup

- The script starts by importing necessary modules and setting up command-line argument parsing.
- A dictionary is created to store packet statistics.
- Another dictionary maps common port numbers to protocol names.

### Functions

- **get_protocol_name(packet)**:
  - Returns the protocol name based on port numbers or the IP protocol field.
  - Checks for TCP and UDP layers and matches port numbers to known protocols.
  - Checks for the IP layer to identify TCP, UDP, and ICMP protocols.

- **analyze_packet(packet)**:
  - Analyzes each captured packet to extract protocol, source IP, destination IP, source port, and destination port.
  - Updates the packet statistics dictionary.
  - Prints packet details to the console.

### Main Function

- Parses command-line arguments to get the network interface.
- Starts packet sniffing on the specified interface using Scapy.
- Handles exceptions and prints packet statistics when sniffing is stopped.

## Notes

- The script must be run with root privileges to capture packets.
- Ensure the specified network interface is valid and active.

## License

This project is licensed under the MIT License. 
```

This README file should give a clear understanding of how to use and what to expect from the packet Analyzer script provided.